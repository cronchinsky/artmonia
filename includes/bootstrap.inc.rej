***************
*** 2778,2783 ****
        unset($_GET['destination']);
        unset($_REQUEST['destination']);
      }
      // If there's still something in $_REQUEST['destination'] that didn't come
      // from $_GET, check it too.
      if (isset($_REQUEST['destination']) && (!isset($_GET['destination']) || $_REQUEST['destination'] != $_GET['destination']) && url_is_external($_REQUEST['destination'])) {
--- 2778,2788 ----
        unset($_GET['destination']);
        unset($_REQUEST['destination']);
      }
+     // Use the DrupalRequestSanitizer to ensure that the destination's query
+     // parameters are not dangerous.
+     if (isset($_GET['destination'])) {
+       DrupalRequestSanitizer::cleanDestination();
+     }
      // If there's still something in $_REQUEST['destination'] that didn't come
      // from $_GET, check it too.
      if (isset($_REQUEST['destination']) && (!isset($_GET['destination']) || $_REQUEST['destination'] != $_GET['destination']) && url_is_external($_REQUEST['destination'])) {
